'use strict';

var handler = require('./lib/request-handler.js');
var express = require('express');
var app = express();
var bodyParser = require('body-parser');
var sessions = require("client-sessions");
var cors = require('cors');

app.use(cors());
app.use(sessions({
  cookieName: 'mySession', // cookie name dictates the key name added to the request object
  secret: 'blargadeeblargblarg', // should be a large unguessable string
  resave: true,
  duration: 24 * 60 * 60 * 1000, // how long the session will stay valid in ms
  activeDuration: 1000 * 60 * 5, // if expiresIn < activeDuration, the session will be extended by activeDuration milliseconds
  saveInitialized: true
}));

app.use(bodyParser.urlencoded({ extended: true }));
app.use(bodyParser.json());
app.use(express.static(__dirname + '/public'));
app.use('/scripts', express.static(__dirname + '/node_modules'));
app.use('/compiled', express.static(__dirname + '/compiled'));

app.post('/signup', handler.signupUser);
app.post('/login', handler.signinUser);
app.get('/login', function (req, res) {
  console.log('loeijwfloejfelifjdp');
});

//////////////////
//Handling friends
//////////////////

//friend requests
app.post('/listRequests', handler.listRequests);
app.post('/sendRequest', handler.sendRequest);
//Friend requests
app.post('/getThisFriendsMovies', handler.getThisFriendsMovies);
app.post('/logout', handler.logout);

app.post('/sendWatchRequest', handler.sendWatchRequest);
app.delete('/sendWatchRequest', handler.removeWatchRequest);

app.post('/decline', handler.decline);
app.post('/accept', handler.accept);
app.delete('/removeRequest', handler.removeRequest);

app.post('/findMovieBuddies', handler.findMovieBuddies);
app.post('/getFriends', handler.getFriends);
app.get('/getFriendList', handler.getFriendList);

//////////////////
//Handling movies
//////////////////
app.post('/ratemovie', handler.rateMovie);
app.get('/recentRelease', handler.getRecentRelease);
app.get('/getUserRatings', handler.getUserRatings);
app.get('/getFriendUserRatings', handler.getFriendUserRatings);
app.post('/getMultipleMovieRatings', handler.getMultipleMovieRatings);
app.post('/getFriendRatings', handler.handleGetFriendRatings);
app.get('/searchRatedMovie', handler.searchRatedMovie);

var port = process.env.PORT || 3000;
app.listen(port, function () {
  console.log('listening on port 3000!');
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NlcnZlci5qcyJdLCJuYW1lcyI6WyJoYW5kbGVyIiwicmVxdWlyZSIsImV4cHJlc3MiLCJhcHAiLCJib2R5UGFyc2VyIiwic2Vzc2lvbnMiLCJjb3JzIiwidXNlIiwiY29va2llTmFtZSIsInNlY3JldCIsInJlc2F2ZSIsImR1cmF0aW9uIiwiYWN0aXZlRHVyYXRpb24iLCJzYXZlSW5pdGlhbGl6ZWQiLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJqc29uIiwic3RhdGljIiwiX19kaXJuYW1lIiwicG9zdCIsInNpZ251cFVzZXIiLCJzaWduaW5Vc2VyIiwiZ2V0IiwicmVxIiwicmVzIiwiY29uc29sZSIsImxvZyIsImxpc3RSZXF1ZXN0cyIsInNlbmRSZXF1ZXN0IiwiZ2V0VGhpc0ZyaWVuZHNNb3ZpZXMiLCJsb2dvdXQiLCJzZW5kV2F0Y2hSZXF1ZXN0IiwiZGVsZXRlIiwicmVtb3ZlV2F0Y2hSZXF1ZXN0IiwiZGVjbGluZSIsImFjY2VwdCIsInJlbW92ZVJlcXVlc3QiLCJmaW5kTW92aWVCdWRkaWVzIiwiZ2V0RnJpZW5kcyIsImdldEZyaWVuZExpc3QiLCJyYXRlTW92aWUiLCJnZXRSZWNlbnRSZWxlYXNlIiwiZ2V0VXNlclJhdGluZ3MiLCJnZXRGcmllbmRVc2VyUmF0aW5ncyIsImdldE11bHRpcGxlTW92aWVSYXRpbmdzIiwiaGFuZGxlR2V0RnJpZW5kUmF0aW5ncyIsInNlYXJjaFJhdGVkTW92aWUiLCJwb3J0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJsaXN0ZW4iXSwibWFwcGluZ3MiOiI7O0FBQ0EsSUFBSUEsVUFBVUMsUUFBUSwwQkFBUixDQUFkO0FBQ0EsSUFBSUMsVUFBVUQsUUFBUSxTQUFSLENBQWQ7QUFDQSxJQUFJRSxNQUFNRCxTQUFWO0FBQ0EsSUFBSUUsYUFBYUgsUUFBUSxhQUFSLENBQWpCO0FBQ0EsSUFBSUksV0FBV0osUUFBUSxpQkFBUixDQUFmO0FBQ0EsSUFBSUssT0FBT0wsUUFBUSxNQUFSLENBQVg7O0FBRUFFLElB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L0MsSUFBSWdELE1BQUosQ0FBV0osSUFBWCxFQUFpQixZQUFZO0FBQzNCdEIsVUFBUUMsR0FBUixDQUFZLHlCQUFaO0FBQ0QsQ0FGRCIsImZpbGUiOiJzZXJ2ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxudmFyIGhhbmRsZXIgPSByZXF1aXJlKCcuL2xpYi9yZXF1ZXN0LWhhbmRsZXIuanMnKTtcclxudmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbnZhciBhcHAgPSBleHByZXNzKCk7XHJcbnZhciBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcclxudmFyIHNlc3Npb25zID0gcmVxdWlyZShcImNsaWVudC1zZXNzaW9uc1wiKTtcclxudmFyIGNvcnMgPSByZXF1aXJlKCdjb3JzJyk7XHJcblxyXG5hcHAudXNlKGNvcnMoKSk7XHJcbmFwcC51c2Uoc2Vzc2lvbnMoe1xyXG4gIGNvb2tpZU5hbWU6ICdteVNlc3Npb24nLCAvLyBjb29raWUgbmFtZSBkaWN0YXRlcyB0aGUga2V5IG5hbWUgYWRkZWQgdG8gdGhlIHJlcXVlc3Qgb2JqZWN0XHJcbiAgc2VjcmV0OiAnYmxhcmdhZGVlYmxhcmdibGFyZycsIC8vIHNob3VsZCBiZSBhIGxhcmdlIHVuZ3Vlc3NhYmxlIHN0cmluZ1xyXG4gIHJlc2F2ZTogdHJ1ZSxcclxuICBkdXJhdGlvbjogMjQgKiA2MCAqIDYwICogMTAwMCwgLy8gaG93IGxvbmcgdGhlIHNlc3Npb24gd2lsbCBzdGF5IHZhbGlkIGluIG1zXHJcbiAgYWN0aXZlRHVyYXRpb246IDEwMDAgKiA2MCAqIDUsIC8vIGlmIGV4cGlyZXNJbiA8IGFjdGl2ZUR1cmF0aW9uLCB0aGUgc2Vzc2lvbiB3aWxsIGJlIGV4dGVuZGVkIGJ5IGFjdGl2ZUR1cmF0aW9uIG1pbGxpc2Vjb25kc1xyXG4gIHNhdmVJbml0aWFsaXplZDogdHJ1ZVxyXG59KSk7XHJcblxyXG5hcHAudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7ZXh0ZW5kZWQ6IHRydWV9KSk7XHJcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKCkpO1xyXG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKF9fZGlybmFtZSArICcvcHVibGljJykpO1xyXG5hcHAudXNlKCcvc2NyaXB0cycsIGV4cHJlc3Muc3RhdGljKF9fZGlybmFtZSArICcvbm9kZV9tb2R1bGVzJykpO1xyXG5hcHAudXNlKCcvY29tcGlsZWQnLCBleHByZXNzLnN0YXRpYyhfX2Rpcm5hbWUgKyAnL2NvbXBpbGVkJykpO1xyXG5cclxuYXBwLnBvc3QoJy9zaWdudXAnLCBoYW5kbGVyLnNpZ251cFVzZXIpO1xyXG5hcHAucG9zdCgnL2xvZ2luJywgaGFuZGxlci5zaWduaW5Vc2VyKTtcclxuYXBwLmdldCgnL2xvZ2luJyxmdW5jdGlvbihyZXEscmVzKXtcclxuXHRjb25zb2xlLmxvZygnbG9laWp3ZmxvZWpmZWxpZmpkcCcpXHJcbn0pXHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy9IYW5kbGluZyBmcmllbmRzXHJcbi8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuLy9mcmllbmQgcmVxdWVzdHNcclxuYXBwLnBvc3QoJy9saXN0UmVxdWVzdHMnLCBoYW5kbGVyLmxpc3RSZXF1ZXN0cyk7XHJcbmFwcC5wb3N0KCcvc2VuZFJlcXVlc3QnLCBoYW5kbGVyLnNlbmRSZXF1ZXN0KTtcclxuLy9GcmllbmQgcmVxdWVzdHNcclxuYXBwLnBvc3QoJy9nZXRUaGlzRnJpZW5kc01vdmllcycsaGFuZGxlci5nZXRUaGlzRnJpZW5kc01vdmllcylcclxuYXBwLnBvc3QoJy9sb2dvdXQnLCBoYW5kbGVyLmxvZ291dCk7XHJcblxyXG5hcHAucG9zdCgnL3NlbmRXYXRjaFJlcXVlc3QnLGhhbmRsZXIuc2VuZFdhdGNoUmVxdWVzdClcclxuYXBwLmRlbGV0ZSgnL3NlbmRXYXRjaFJlcXVlc3QnLCBoYW5kbGVyLnJlbW92ZVdhdGNoUmVxdWVzdClcclxuXHJcbmFwcC5wb3N0KCcvZGVjbGluZScsIGhhbmRsZXIuZGVjbGluZSk7XHJcbmFwcC5wb3N0KCcvYWNjZXB0JywgaGFuZGxlci5hY2NlcHQpO1xyXG5hcHAuZGVsZXRlKCcvcmVtb3ZlUmVxdWVzdCcsIGhhbmRsZXIucmVtb3ZlUmVxdWVzdClcclxuXHJcbmFwcC5wb3N0KCcvZmluZE1vdmllQnVkZGllcycsaGFuZGxlci5maW5kTW92aWVCdWRkaWVzKVxyXG5hcHAucG9zdCgnL2dldEZyaWVuZHMnLGhhbmRsZXIuZ2V0RnJpZW5kcylcclxuYXBwLmdldCgnL2dldEZyaWVuZExpc3QnLCBoYW5kbGVyLmdldEZyaWVuZExpc3QpXHJcblxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vSGFuZGxpbmcgbW92aWVzXHJcbi8vLy8vLy8vLy8vLy8vLy8vL1xyXG5hcHAucG9zdCgnL3JhdGVtb3ZpZScsIGhhbmRsZXIucmF0ZU1vdmllKTtcclxuYXBwLmdldCgnL3JlY2VudFJlbGVhc2UnLCBoYW5kbGVyLmdldFJlY2VudFJlbGVhc2UpO1xyXG5hcHAuZ2V0KCcvZ2V0VXNlclJhdGluZ3MnLCBoYW5kbGVyLmdldFVzZXJSYXRpbmdzKTtcclxuYXBwLmdldCgnL2dldEZyaWVuZFVzZXJSYXRpbmdzJywgaGFuZGxlci5nZXRGcmllbmRVc2VyUmF0aW5ncyk7XHJcbmFwcC5wb3N0KCcvZ2V0TXVsdGlwbGVNb3ZpZVJhdGluZ3MnLCBoYW5kbGVyLmdldE11bHRpcGxlTW92aWVSYXRpbmdzKTtcclxuYXBwLnBvc3QoJy9nZXRGcmllbmRSYXRpbmdzJywgaGFuZGxlci5oYW5kbGVHZXRGcmllbmRSYXRpbmdzKTtcclxuYXBwLmdldCgnL3NlYXJjaFJhdGVkTW92aWUnLCBoYW5kbGVyLnNlYXJjaFJhdGVkTW92aWUpO1xyXG5cclxuXHJcbnZhciBwb3J0ID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCAzMDAwO1xyXG5hcHAubGlzdGVuKHBvcnQsIGZ1bmN0aW9uICgpIHtcclxuICBjb25zb2xlLmxvZygnbGlzdGVuaW5nIG9uIHBvcnQgMzAwMCEnKTtcclxufSk7Il19